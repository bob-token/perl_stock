sub MSH_DropDB{
	my $dbh=shift;
	my $db_name=shift;
	#create db
	my $sql=sprintf("DROP DATABASE  %s ;",$db_name);
	$dbh->do($sql);
}
sub MSH_CreateDB{
	my $dbh=shift;
	my $db_name=shift;
	#create db
	my $sql=sprintf("CREATE DATABASE  %s ;",$db_name);
	$dbh->do($sql);
}
sub MSG_GetAllTablesName{
	my $dbh=shift;
	my $db_name=shift;
	#use database;
	my $sql=sprintf("USE %s ;",$db_name);
	$dbh->do($sql);
	#show tables
	$sql=("SHOW TABLES;");
	my $sth =$dbh->prepare($sql);
	$sth->execute();
	my @names=();
	while(my $code=$sth->fetchrow_array){
		push @names,$code;
	}
	return join('',@names,'');
}
sub MSH_CreateTable{
	my $dbh=shift;
	my $TableName=shift;
	my $CreateDefinition=shift;
	my $sql=sprintf("CREATE TABLE %s (%s);",$TableName,$CreateDefinition);
	return $dbh->do($sql);
}
sub MSH_CreateTableIfNotExist{
	my $dbh=shift;
	my $TableName=shift;
	my $CreateDefinition=shift;
	my $sql=sprintf("CREATE TABLE IF NOT EXISTS %s (%s);",$TableName,$CreateDefinition);
	return $dbh->do($sql);
}
sub MSH_SetUniqueKey{
	my $dbh=shift;
	my $TableName=shift;
	my $Key=shift;
	my $sql=sprintf("ALTER TABLE  %s ADD UNIQUE (%s);",$TableName,$Key);
	$dbh->do($sql);
}
ub MSH_DropDB{
	my $dbh=shift;
	my $db_name=shift;
	#create db
	my $sql=sprintf("DROP DATABASE  %s ;",$db_name);
	$dbh->do($sql);
}
sub MSH_CreateDB{
	my $dbh=shift;
	my $db_name=shift;
	#create db
	my $sql=sprintf("CREATE DATABASE  %s ;",$db_name);
	$dbh->do($sql);
}
sub MSG_GetAllTablesName{
	my $dbh=shift;
	my $db_name=shift;
	#use database;
	my $sql=sprintf("USE %s ;",$db_name);
	$dbh->do($sql);
	#show tables
	$sql=("SHOW TABLES;");
	my $sth =$dbh->prepare($sql);
	$sth->execute();
	my @names=();
	while(my $code=$sth->fetchrow_array){
		push @names,$code;
	}
	return join('',@names,'');
}
sub MSH_CreateTable{
	my $dbh=shift;
	my $TableName=shift;
	my $CreateDefinition=shift;
	my $sql=sprintf("CREATE TABLE %s (%s);",$TableName,$CreateDefinition);
	return $dbh->do($sql);
}
sub MSH_CreateTableIfNotExist{
	my $dbh=shift;
	my $TableName=shift;
	my $CreateDefinition=shift;
	my $sql=sprintf("CREATE TABLE IF NOT EXISTS %s (%s);",$TableName,$CreateDefinition);
	return $dbh->do($sql);
}
sub MSH_SetUniqueKey{
	my $dbh=shift;
	my $TableName=shift;
	my $Key=shift;
	my $sql=sprintf("ALTER TABLE  %s ADD UNIQUE (%s);",$TableName,$Key);
	$dbh->do($sql);
}
1;
